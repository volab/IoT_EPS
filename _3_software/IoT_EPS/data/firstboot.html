<!DOCTYPE html>
<html>
    <head>
    <!-- Entête de la page -->
        <meta charset="UTF-8" />
        
        <!--Import css-->
        <link
            rel="stylesheet"
            type="text/css"
            href="css/style.css" />
        <link
            rel="stylesheet"
            media="screen"
            type="text/css"
            href="css/style.css" />

        <link rel="icon" href="volab.ico" />

        <title>Démarrage IoT_EPS</title>
    </head>
    
    <body class="bg-lightBlue">
        <header> <!-- Logo + Titre de la page -->
            <div class="row">
                <div class="FB_DIV_Logo">
                        <img class="FB_logo" src="img/logo_alpha.png" alt="logo IoT_EPS"/>
                </div>
                <div >
                    <h1 class="header_h1">Démarrage IoT_EPS</h1>
                </div>
            </div>
            
        </header>

        <main> <!-- corp de la page -->
            <div class="FB_fieldset_color">
                <form
                    action="/firstBoot"
                    method="post">
                        <span>
                            <input type="hidden" class="hidden" name="firstBoot" value="firstBootForm">
                        </span>
                        <div class="AP">
                            <label for="AP_select">
                                <input
                                    type="radio"
                                    name="mode_selector"
                                    id="AP_select"
                                    value="AP"
                                    onclick="checkAP()" >
                                <span>Point d'accès WIFI (réseau autonome)</span>
                            </label><br><br>
                            <span>Saisir le SSID pour le mode Point d'accès</span><br>
                            <input
                                type="text"
                                name="AP_SSID"
                                id="id_AP_SSID"
                                value="default_AP_SSID" >
                            <br>
                            <span>Saisir le mot de passe du mode Point d'accès
                                    <br>(Mot de passe par défaut : "123456789")
                            </span><br>
                            <input
                                type="password"
                                name="AP_PWD"
                                id="id_AP_PWD"
                                value="123456789" >
                                <br>
                            <div id="FB_AP_WARNING">La longueur du mot de passe doit être comprise entre 8 et 63 caractères.</div>
                            <br>***<br>
                        </div>
                        <div class="STA">
                            <!--FB_WARNING_TAG-->
                            <label for="STA_select">
                                <input
                                    type="radio"
                                    name="mode_selector"
                                    id="STA_select"
                                    value="STA"
                                    onclick="checkSTA()" >
                                <span>Joindre un réseau existant</span>
                            </label><br><br>
                            <span>Saisir le SSID du réseau à joindre</span><br>
                            <input 
                                type="text"
                                name="STA_SSID"
                                id="id_STA_SSID"
                                value=""
                                placeholder="saisir le SSID"
                                required >
                            <br>
                            <span>Saisir le mot de passe du réseau à joindre</span><br>
                            <input
                                type="password"
                                name="STA_PWD"
                                id="id_STA_PWD"
                                value=""
                                placeholder="saisir le mot de passe"
                                required >
                            <br><br>***<br><br>
                        </div>
                        <div class="submitReset">
                            <input 
                                type="submit"
                                id="FB_SUBMIT"
                                class="submit AP_STA_SUBMIT" 
                                default>
                            <input
                                type="reset"
                                class="reset AP_STA_SUBMIT" > 
                        </div>
                </form>
            </div>
        </main>

        <script>
            const AP_SSID = document.getElementById("id_AP_SSID");
            const AP_PWD = document.getElementById("id_AP_PWD");
            const AP_select = document.getElementById("AP_select");
            const AP_PWD_WARNING = document.getElementById("FB_AP_WARNING");

            const STA_SSID = document.getElementById("id_STA_SSID");
            const STA_PWD = document.getElementById("id_STA_PWD");
            const STA_select = document.getElementById("STA_select");

            const BTN_SUBMIT = document.getElementById("FB_SUBMIT");

            const PWD_MIN = 8;
            const PWD_MAX = 63;



            function checkAP(){
                checkLength();
                STA_SSID.disabled = true;
                STA_PWD.disabled = true;
                AP_SSID.disabled = false;
                AP_PWD.disabled = false;
                AP_select.checked = true;
            }

            function checkSTA(){
                showHide("hide");
                STA_SSID.disabled = false;
                STA_PWD.disabled = false;
                AP_SSID.disabled = true;
                AP_PWD.disabled = true;
                STA_select.checked = true;
            }

            AP_PWD_WARNING.hidden = true;
            checkAP();

            function showHide(show_hide){
                if (show_hide == "show"){
                    BTN_SUBMIT.disabled = true;
                    AP_PWD_WARNING.hidden = false;
                } else if (show_hide == "hide"){
                    BTN_SUBMIT.disabled = false;
                    AP_PWD_WARNING.hidden = true;
                }
            }

            function checkLength(){
                if ((AP_PWD.value.length < PWD_MIN) || (AP_PWD.value.length > PWD_MAX)){
                    showHide("show");
                } else {
                    showHide("hide");
                }
            }

            AP_PWD.addEventListener("input", (event)=>{
                checkLength();
            });

        </script>

    </body>
</html>
